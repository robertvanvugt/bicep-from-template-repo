job1:
  runs-on: ubuntu-latest
  outputs:
    appServiceAppName: ${{ steps.deploy.outputs.appServiceAppName }} # Refers to 'deploy' id provided below.
  steps:
  - uses: actions/checkout@v2
  - uses: azure/login@v1
    name: Sign in to Azure
    with:
      client-id: ${{ secrets.AZURE_CLIENT_ID }}
      tenant-id: ${{ secrets.AZURE_TENANT_ID }}
      subscription-id: ${{ secrets.AZURE_SUBSCRIPTION_ID }}
  - uses: azure/arm-deploy@v1
    id: deploy # Deploy id us used in outputs above.
    name: Deploy Bicep file
    with:
      failOnStdErr: false
      deploymentName: ${{ github.run_number }}
      template: ./deploy/main.bicep

job2:
  needs: job1
  runs-on: ubuntu-latest
  steps:

- name: Upload folder as a workflow artifact
  uses: actions/upload-artifact@v2
  with:
    name: my-artifact-name
    path: ./my-folder

- uses: actions/download-artifact@v2

- uses: actions/download-artifact@v2
  with:
    name: my-artifact-name

- uses: azure/webapps-deploy@v2
  with:
    app-name: my-app-service
    package: my-artifact-name/website.zip